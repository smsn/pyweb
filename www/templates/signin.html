{% extends '_base.html' %}

{% block title %}登录{% endblock %}

{% block beforehead %}
<script>
  $(function () {
    var vmAuth = new Vue({
      el: '#log-form',
      data: {
        email: '',
        password: ''
      },
      methods: {
        submit: function (event) {
          event.preventDefault();
          var
            $form = $('#log-form'),
            email = this.email.trim().toLowerCase(),
            data = {
              email: email,
              password: this.password === '' ? '' : CryptoJS.SHA1(email + ':' + this.password).toString()
            };
          $form.postJSON('/api/signin', data, function (err, result) {
            // 正常登录之后,将转到首页
            if (!err) {
              return location.assign('/');
            }
          });
        }
      }
    });
  });
</script>
{% endblock %}

{% block nav %}
<header>
  <div class="log-header">
    <a href="/"><button type="button" class="am-btn am-btn-default am-radius log-button">首 页</button></a>
  </div>
  <div class="log-re">
      <a href="/register"><button type="button" class="am-btn am-btn-default am-radius log-button">注 册</button></a>
  </div>
</header>
{% endblock %}


{% block content %}
<div class="log">
  <div class="am-g">
    <div class="am-u-lg-3 am-u-md-6 am-u-sm-8 am-u-sm-centered log-content">

      <h1 class="log-title am-animation-slide-top">登 录</h1>
      <br>

      <!-- <form action="/api/signin" method="post" class="am-form" id="log-form"> -->
      <form id="log-form" @submit="submit" class="am-form">

        <div class="am-input-group am-radius am-animation-slide-left">
          <input v-model="email" type="email" id="doc-vld-email-2-1" class="am-radius" data-validation-message="请输入正确邮箱地址" placeholder="邮箱" required>
          <span class="am-input-group-label log-icon am-radius"><i class="am-icon-user am-icon-sm am-icon-fw"></i></span>
        </div>
        <br>

        <div class="am-input-group am-animation-slide-left log-animation-delay">
          <input v-model="password" type="text" class="am-form-field am-radius log-input" placeholder="密码" minlength="11" required>
          <span class="am-input-group-label log-icon am-radius"><i class="am-icon-lock am-icon-sm am-icon-fw"></i></span>
        </div>
        <br>

        <button type="submit" class="am-btn am-btn-primary am-btn-block am-btn-lg am-radius am-animation-slide-bottom log-animation-delay">登 录</button>

        <p class="am-animation-slide-bottom log-animation-delay"><a href="#">忘记密码?</a></p>

      </form>
    </div>
  </div>
  {% endblock %}



  {% block footer %}
  <footer class="log-footer">
    © 2014 AllMobilize, Inc. Licensed under MIT license.
  </footer>
</div>
  {% endblock %}